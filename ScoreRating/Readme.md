# 健康评定算法

## 1.理论设计

### 1.1理论部分

整体框架

![image-20220406232446794](C:\Users\96919\AppData\Roaming\Typora\typora-user-images\image-20220406232446794.png)

#### 1.1.1工况评分算法

在上一部分内容中，通过工况识别预测算法获取了扶梯各个部件的运行工况和潜在故障情况。基于这一预测信息，利用查表评分机制获取当前时间点的部件工况得分，然后对一定采样周期中的部件得分取平均值，作为最后的部件工况评分。

* 评分表示例：本系统具体采用的评分表见1.2节

| 部件工况  | 评分 |
| :-------: | :--: |
|   正常    |  g1  |
| 潜在故障1 |  g2  |
| 潜在故障2 |  g3  |
|    ...    |      |

* 评分模型：

$$
G_{总} = \frac{g_{t1} + g_{t2} + ... + g_{tN}}{N_{采样次数}}
$$

#### 1.1.2健康评分算法

在上一节中，通过工况评分算法获取了各个部件的当前工况评分，基于这一评分，利用加权平均机制获取最终整个扶梯的整体健康评分。其中权重是一项可以自行设置的参数，这一参数对应着每一个部件在扶梯健康评估中的重要性。权重参数值越高，这一部件的安全性越重要。

* 评分模型：

$$
G_{总} = \frac{N_1 G_1 + N_2 G_2 + N_3 G_3}{N1 + N2 + N3}
$$

### 1.2工况评分表

#### 1.2.1工况评分表内容

工况评分表是用于部件工况评分的。其中Label是通过工况识别判定算法预测识别到的扶梯工况，Grade是针对这一工况的评分。

* WorkConditionRatingTable_motor：针对单模型--电机工况识别模型获取的结果进行评分的表

| Label | Grade |
| :---: | :---: |
|   1   |  100  |
|   2   |  80   |
|   3   |  60   |

* WorkConditionRatingTable_reducer：针对单模型--减速箱工况识别模型获取的结果进行评分的表

| Label | Grade |
| :---: | :---: |
|   4   |  100  |
|   5   |  80   |
|   6   |  80   |
|   7   |  60   |
|   8   |  60   |

* WorkConditionRatingTable_bolt：针对单模型--地脚螺栓工况识别模型获取的结果进行评分的表

| Label | Grade |
| :---: | :---: |
|   9   |  100  |
|  10   |  80   |
|  11   |  60   |

* WorkConditionRatingTable_complicatd：针对混合模型获取的结果进行评分的表

| Label | Grade |
| :---: | :---: |
|   0   |  100  |
|   1   |  100  |
|   2   |  100  |
|   3   |  100  |
|   4   |  100  |
|   5   |  80   |
|   6   |  60   |
|   7   |  80   |
|   8   |  60   |

#### 1.2.2工况评分表说明

工况评分表储存路径：'./WorkConditionRatingTable/'

### 1.3工况评分权值

工况评分权值默认值全为1；即所有部件的安全性能同等重要。

## 2.算法实现

### 工况评分方法

* 功能：基于工况评分表，利用查表机制，获取部件当前工况的评分。
* 方法封装：`[ Flag, Grade ] = WorkConditionRating( Label, ModelName )`
* 封装说明：
  * 输入：
    * Label：基于对应的工况识别判定算法预测识别到的扶梯工况标签号
    * ModelName：上述标签号获取时使用的分类模型的模型后缀名
  * 输出：
    * Flag：方法调用的标志返回值，用于判断方法是否调用成功和排查错误原因
      * Flag=1：调用方法成功，并获取结果
      * Flag=-1：调用方法失败，错误原因在于输入的模型后缀名错误
      * Flag=-2：调用方法失败，错误原因在于输入的工况标签号错误
    * Grade：基于工况评分表获取的部件当前工况的评分

### 健康综合评分方法

* 功能：基于单个部件的工况评分，利用加权平均机制，获取最终的健康评分。
* 方法封装：`[ Flag, Score] = HealthScoreRating( Grades, Weight)`
* 封装说明：
  * 输入：
    * Grades：基于工况评分方法获取的三个部件的对应评分，以数组形式输入
    * Weight：三个部件的评分在最终整体评分中所占的权值
  * 输出：
    * Flag：方法调用的标志返回值，用于判断方法是否调用成功和排查错误原因
      * Flag=1：调用方法成功，并获取结果
      * Flag=-1：调用方法失败，错误原因在于输入数据长度错误
    * Score：基于加权平均机制获取的最后的扶梯的整体健康评分